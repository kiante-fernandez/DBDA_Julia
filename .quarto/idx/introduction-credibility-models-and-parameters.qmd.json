{"title":"Introduction: Credibility, Models, and Parameters","markdown":{"yaml":{"format":{"html":{"code-fold":false}},"jupyter":"julia-1.7"},"headingText":"Introduction: Credibility, Models, and Parameters","containsRefs":false,"markdown":"\n\n\n## Bayesian inference is reallocation of credibility across possibilities\n\nTo make Figure 2.1 we need data. We will create some synthetic data and store it in using `DataFrames.jl`\n\n```{julia}\n#| warning: false\n#| output: false\n\nusing DataFrames\n\nfunction expand_grid(; iters...)\n    var_names = collect(keys(iters))\n    var_itr = [1:length(x) for x in iters.data]\n    var_ix = vcat([collect(x)' for x in Iterators.product(var_itr...)]...)\n    out = DataFrame()\n    for i = 1:length(var_names)\n        out[:,var_names[i]] = collect(iters[i])[var_ix[:,i]]\n    end\n    return out\nend\n\nd = expand_grid(iteration=1:3, Possibilities=[\"A\", \"B\",\"C\", \"D\"], stage = [\"Prior\", \"Posterior\"])\n\nd2 =DataFrame(Credibility =[fill(.25,4); 0; fill(1/3,3); 0; fill(1/3,3);0;.5;0;0.5;0;.5;0;0.5;fill(0,3);1])\n\nsort!(d, [:iteration])\nd.Credibility = d2.Credibility\n\n```\n\nHere we are defining a function that creates combinations and then I just bind that we the Credibility values we will use for plotting. \n\nWe can take a look at the top few rows of the data with the `first()` function.\n\n```{julia}\nfirst(d,5)\n```\n\nNow lets plot our version of Figure 2.1. To do so, we will use the `Gadfly.jl` package. This is my preferred plotting package because it has similar syntax to ggplot2 package in R.\n\n\n```{julia}\n#| warning: false\n#| echo: false\n\nusing Gadfly\nusing DataFramesMeta\n\n#Specify the plot size\nset_default_plot_size(16cm, 18cm)\n\ndf_Prior = @where(d, :stage .== \"Prior\")\ndf_Posterior = @where(d, :stage .== \"Posterior\")\n\nfig1a = plot(df_Prior,\n    xgroup = :iteration,\n    x = :Possibilities,\n    y = :Credibility,\n    Geom.subplot_grid(Geom.bar(orientation = :vertical),\n    Guide.xlabel(orientation= :horizontal),\n    Guide.xticks(orientation = :horizontal)),\n    Guide.xlabel(\"Possibilities\"),\n    Guide.ylabel(\"Credibility\"),\n    Guide.title(\"Prior\"),\n    Scale.y_continuous(format = :plain),\n    Theme(\n        background_color = \"white\",\n        bar_spacing = 1mm,\n        grid_color = \"white\"\n    )\n)\nfig1b = plot(df_Posterior,\n    xgroup = :iteration,\n    x = :Possibilities,\n    y = :Credibility,\n    Geom.subplot_grid(Geom.bar(orientation = :vertical),\n    Guide.xlabel(orientation= :horizontal),\n    Guide.xticks(orientation = :horizontal)),\n    Guide.xlabel(\"Possibilities\"),\n    Guide.ylabel(\"Credibility\"),\n    Guide.title(\"Posterior\"),\n    Scale.y_continuous(format = :plain),\n    Theme(\n        background_color = \"white\",\n        bar_spacing = 1mm,\n        grid_color = \"white\"\n    )\n)\n#create a subplot\nvstack(fig1a,fig1b)\n```\n\nhttps://stackoverflow.com/questions/50925450/gadfly-julia-how-to-add-text-annotation-to-a-plot\n\n```{julia}\nusing Compose #need to add Pkg still.\n#to add the text to the plotting\n#Guide.annotation(compose(context(), text(0.8, 0.8, \"Some text\")\n\n```\n\n### Data are noisy and inferences are probabilistic.\n\n```{julia}\nusing Gadfly\nusing Distributions\n\nset_default_plot_size(16cm, 18cm)\n\nd = Normal()\nσ = 2\nx1 = rand(Normal(1, σ), 10^5)\nx2 = rand(Normal(4, σ), 10^5)\nx3 = rand(Normal(7, σ), 10^5)\nx4 = rand(Normal(10, σ), 10^5)\nusing DataFrames\nx5 = DataFrame(Possibilities = 1, Credibility = 0.2)\nx6 = DataFrame(Possibilities = 4, Credibility = 0.2)\nx7 = DataFrame(Possibilities = 7, Credibility = 0.2)\nx8 = DataFrame(Possibilities = 10, Credibility = 0.2)\n\nplot(layer(x=x1, Geom.density, color=[\"auto\"]),\n    layer(x=x2, Geom.density, color=[\"auto\"]),\n    layer(x=x3, Geom.density, color=[\"auto\"]),\n    layer(x=x4, Geom.density, color=[\"auto\"]),\n    Guide.xlabel(\"Possibilities\"),\n    Guide.ylabel(\"Credibility\"),\n    Guide.title(\"Prior\"),\n    Theme(\n        background_color = \"white\",\n        grid_color = \"white\"\n    ),\n    layer(x5, x = :Possibilities, y = :Credibility, Geom.bar(orientation = :vertical)),\n    layer(x6, x = :Possibilities, y = :Credibility, Geom.bar(orientation = :vertical)),\n    layer(x7, x = :Possibilities, y = :Credibility, Geom.bar(orientation = :vertical)),\n    layer(x8, x = :Possibilities, y = :Credibility, Geom.bar(orientation = :vertical))   )\n    #found the correct way to do this!\n    # plot(layer(x->pdf(d, x), -4, 4, color=[colorant\"black\"]),\n    #  Theme(\n    #     background_color = \"white\",\n    #     grid_color = \"white\"\n    # ))\n\n\n```\n\n## Possibilities are parameter values in descriptive models\n\n## The steps of Bayesian data analysis\n\n> In general, Bayesian analysis of data follows these steps:\n>\n> 1. Identify the data relevant to the research questions. What are the measurement scales of the data? Which data variables are to be predicted, and which data variables are supposed to act as predictors?\n> 2. Define a descriptive model for the relevant data. The mathematical form and its parameters should be meaningful and appropriate to the theoretical purposes of the analysis.\n> 3. Specify a prior distribution on the parameters. The prior must pass muster with the audience of the analysis, such as skeptical scientists.\n> 4. Use Bayesian inference to re-allocate credibility across parameter values. Interpret the posterior distribution with respect to theoretically meaningful issues (assuming that the model is a reasonable description of the data; see next step).\n> 5. Check that the posterior predictions mimic the data with reasonable accuracy (i.e., conduct a “posterior predictive check”). If not, then consider a different descriptive model.\n>\n> Perhaps the best way to explain these steps is with a realistic example of Bayesian data analysis. The discussion that follows is abbreviated for purposes of this introductory chapter, with many technical details suppressed. (p. 25)\n\nI will showcase the entire workflow here. In later chapters we’ll cover this workflow in much more detail. \n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"introduction-credibility-models-and-parameters.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.38","bibliography":["references.bib"],"theme":"cosmo","cover-image":"DBDA2Ecover.png","jupyter":"julia-1.7"},"extensions":{"book":{"multiFile":true}}}}}